{% extends "shop/base.html" %}
{% load static %}

{% block title %}
    {% if category %}{{ category.name }}{% else %}Products{% endif %}
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-lg-3 col-md-11 mb-4">
            <div id="sidebar" class="me-4 me-md-4">
                <h3 style="font-family: Aclonica;">Categories</h3>
                <ul>
                    <li {% if not category %}class="selected"{% endif %}>
                        <a style="text-decoration: none; font-family: Aclonica;" href="{% url "shop:product_list" %}">All</a>
                    </li>
                
                    {% for c in categories %}
                    <li {% if category.slug == c.slug %}class="selected"{% endif %}>
                        <a style="text-decoration: none; font-family: Aclonica" href="{{ c.get_absolute_url }}">{{ c.name }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-lg-9">
            <h2 class="mt-4" style="font-family: Aclonica;">{% if category %}{{ category.name }}{% else %}Products{% endif %}</h2>
            <hr>
            <div class="row">
                {% for product in products %}
                    <div class="col-lg-4 col-md-6 mt-3 mb-4">
                            <img class="thumbnail" src="{% if product.image %}{{ product.image.url }}{% else %}{% static "img/no_image.png" %}{% endif %}" alt="">
                            <div class="box-element product">
                                <h6><a style="text-decoration: none; font-family: Aclonica" href="{{ product.get_absolute_url }}">{{ product.name }}</a></h6>
                                <hr>
                                <div class="d-flex">
                                    <form action="{% url 'cart:cart_add' product.id %}" method="post">
                                        {% csrf_token %}
                                        <span style="display: none;">{{ cart_product_form.as_p }}</span>
                                        <button data-product-price="{{ product.price}}" data-totalItems="{{ cart|length }}" data-totalPrice="{{ cart.get_total_price }}" data-id="{{ product.id }}" style="font-family: Aclonica" type="submit" class="btn btn-outline-dark add-btn cart-button">Add to Cart</button>
                                    </form>
                                </div> 
                                <p class="text-end" ><b>${{ product.price }}</b></p>
                            </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
{% endblock %}